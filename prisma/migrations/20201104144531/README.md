# Migration `20201104144531`

This migration has been generated by Max Streitberger at 11/4/2020, 3:45:31 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Vote" ADD COLUMN "answer_id" text   NOT NULL 

ALTER TABLE "public"."Vote" ADD FOREIGN KEY("answer_id")REFERENCES "public"."SurveyAnswer"("answer_id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201104132752..20201104144531
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 model Event {
   event_id                String       @id @default(cuid())
@@ -87,14 +87,15 @@
   @@id([friend_id, following_user_id])
 }
 model Survey {
-  survey_id    String         @id @default(cuid())
-  event_id     String?
-  question     String?
-  created_at   DateTime?      @default(now())
-  event        Event?         @relation(fields: [event_id], references: [event_id])
-  answers      SurveyAnswer[]
+  survey_id  String         @id @default(cuid())
+  event_id   String?
+  question   String?
+  created_at DateTime?      @default(now())
+  event      Event?         @relation(fields: [event_id], references: [event_id])
+  answers    SurveyAnswer[]
+  votes      Vote[]
 }
 model SurveyAnswer {
   answer_id  String    @id @default(cuid())
@@ -104,8 +105,22 @@
   likes      Int?      @default(0)
   survey     Survey?   @relation(fields: [survey_id], references: [survey_id])
 }
+model Vote {
+  user_id     String
+  survey_id   String
+  event_id    String
+  voted_at    DateTime?       @default(now())
+  event       Event           @relation(fields: [event_id], references: [event_id])
+  survey      Survey          @relation(fields: [survey_id], references: [survey_id])
+  user        User            @relation(fields: [user_id], references: [user_id])
+  answer_id   String
+  answer      SurveyAnswer    @relation(fields: [answer_id], references: [answer_id])
+
+  @@id([survey_id, user_id, event_id])
+}
+
 enum EventType {
   LOCAL
   ONLINE
 }
```


