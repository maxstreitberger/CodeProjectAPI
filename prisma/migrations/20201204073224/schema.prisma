generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "linux-musl"]
}

datasource db {
  provider = "postgresql"
  url = "***"
}

model cities {
  name       String    @id
  created_at DateTime? @default(now())
  events     events[]
}

model countries {
  name       String    @id
  created_at DateTime? @default(now())
  events     events[]
}

model event_tasks {
  event_task_id String    @id @default(cuid())
  event_id      String
  title         String
  description   String?
  deadline      DateTime?
  created_at    DateTime? @default(now())
  user_id       String
  events        events    @relation(fields: [event_id], references: [event_id])
  users         users     @relation(fields: [user_id], references: [user_id])
}

model events {
  event_id                String        @id @default(cuid())
  title                   String
  event_start             String?
  description             String?
  is_public               Boolean?      @default(false)
  event_type              EventType?
  street_and_house_number String?
  city_id                 String?
  country_id              String?
  meeting_link            String?
  created_at              DateTime?     @default(now())
  host_id                 String
  zip                     Int?
  event_color             String?       @default("green")
  date                    DateTime?
  cities                  cities?       @relation(fields: [city_id], references: [name])
  countries               countries?    @relation(fields: [country_id], references: [name])
  users                   users         @relation(fields: [host_id], references: [user_id])
  event_tasks             event_tasks[]
  surveys                 surveys[]
  user_event              user_event[]

  @@index([title], name: "event_title_idx")
}

model friends {
  follows_since                          DateTime? @default(now())
  following_user_id                      String
  friend_id                              String
  users_friends_following_user_idTousers users     @relation("friends_following_user_idTousers", fields: [following_user_id], references: [user_id])
  users_friends_friend_idTousers         users     @relation("friends_friend_idTousers", fields: [friend_id], references: [user_id])

  @@id([friend_id, following_user_id])
}

model private_tasks {
  private_task_id String    @id @default(cuid())
  user_id         String
  title           String?
  description     String?
  deadline        DateTime?
  created_at      DateTime? @default(now())
  done            Boolean?  @default(false)
  users           users     @relation(fields: [user_id], references: [user_id])
}

model survey_answers {
  answer_id  String    @id @default(cuid())
  survey_id  String
  answer     String?
  created_at DateTime? @default(now())
  surveys    surveys   @relation(fields: [survey_id], references: [survey_id])
  votes      votes[]
}

model surveys {
  survey_id      String           @id @default(cuid())
  event_id       String
  question       String?
  created_at     DateTime?        @default(now())
  events         events           @relation(fields: [event_id], references: [event_id])
  survey_answers survey_answers[]
  votes          votes[]
}

model user_event {
  event_id  String
  user_id   String
  joined_at DateTime? @default(now())
  events    events    @relation(fields: [event_id], references: [event_id])
  users     users     @relation(fields: [user_id], references: [user_id])

  @@id([event_id, user_id])
}

model users {
  user_id                                  String          @id @default(cuid())
  first_name                               String?
  last_name                                String?
  username                                 String          @unique
  email                                    String?         @unique
  password                                 String?
  role                                     Role?
  created_at                               DateTime?       @default(now())
  last_login                               DateTime?       @default(now())
  confirmed                                Boolean?        @default(false)
  profile_color                            String?         @default("blue")
  is_private                               Boolean?        @default(true)
  event_tasks                              event_tasks[]
  events                                   events[]
  friends_friends_following_user_idTousers friends[]       @relation("friends_following_user_idTousers")
  friends_friends_friend_idTousers         friends[]       @relation("friends_friend_idTousers")
  private_tasks                            private_tasks[]
  user_event                               user_event[]
  votes                                    votes[]

  @@index([first_name], name: "first_name_idx")
  @@index([last_name], name: "last_name_idx")
}

model votes {
  user_id        String
  survey_id      String
  voted_at       DateTime?      @default(now())
  answer_id      String
  survey_answers survey_answers @relation(fields: [answer_id], references: [answer_id])
  surveys        surveys        @relation(fields: [survey_id], references: [survey_id])
  users          users          @relation(fields: [user_id], references: [user_id])

  @@id([survey_id, user_id])
}

enum EventType {
  LOCAL
  ONLINE
}

enum Role {
  ADMIN
  USER
}
